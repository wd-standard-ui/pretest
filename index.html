<!DOCTYPE html>
<html lang="th" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
  <title>WD Exam — Sheets</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" as="style"
        href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;700&display=swap"
        onload="this.rel='stylesheet'">
  <noscript><link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;700&display=swap"></noscript>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Kanit','system-ui','sans-serif'] },
          colors: { brand:'#2563EB', brandSoft:'#EAF2FF' },
          boxShadow: { card:'0 10px 24px rgba(37,99,235,.12)' }
        }
      }
    }
  </script>
  <link rel="stylesheet" href="./styles.css">
  <link rel="stylesheet" href="./print.css" media="print">
</head>
<body class="bg-gray-50 text-gray-800 font-sans">
  <div id="app" class="min-h-screen">
    <!-- Header -->
    <header class="sticky top-0 z-30 bg-white/90 backdrop-blur border-b">
      <div class="max-w-6xl mx-auto px-4 py-3 flex items-center gap-3">
        <img src="./assets/logo.svg" class="h-8 w-8" alt="logo">
        <div>
          <div class="text-lg font-semibold">WD Exam</div>
          <div class="text-xs text-gray-500 -mt-0.5">Google Sheets Backend</div>
        </div>
        <div class="ml-auto">
          <button id="btnPrint" class="hidden md:inline-flex px-3 py-1.5 rounded-lg border text-sm hover:bg-gray-50">พิมพ์</button>
        </div>
      </div>
    </header>

    <!-- Main container -->
    <main class="max-w-6xl mx-auto px-4 py-6">
      <!-- Step 1: choose subject -->
      <section id="view-subjects" class="hidden">
        <h1 class="text-2xl font-bold mb-3">เลือกวิชา</h1>
        <div id="subjectGrid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-3 gap-3"></div>
      </section>

      <!-- Step 2: choose grade & student -->
      <section id="view-setup" class="hidden">
        <h2 class="text-xl font-semibold mb-4">ตั้งค่าเริ่มต้น</h2>
        <div class="grid md:grid-cols-3 gap-4">
          <div class="p-4 bg-white rounded-2xl shadow-card">
            <label class="block text-sm text-gray-600 mb-1">ระดับชั้น</label>
            <select id="selGrade" class="w-full border rounded-xl px-3 py-2"></select>
          </div>
          <div class="p-4 bg-white rounded-2xl shadow-card">
            <label class="block text-sm text-gray-600 mb-1">นักเรียน</label>
            <select id="selStudent" class="w-full border rounded-xl px-3 py-2"></select>
          </div>
          <div class="p-4 bg-white rounded-2xl shadow-card">
            <label class="block text-sm text-gray-600 mb-1">ชุดแบบทดสอบ</label>
            <select id="selExam" class="w-full border rounded-xl px-3 py-2"></select>
          </div>
        </div>
        <div class="mt-6 flex gap-3">
          <button id="btnBackToSubjects" class="px-4 py-2 rounded-xl border">ย้อนกลับ</button>
          <button id="btnContinue" class="px-4 py-2 rounded-xl bg-brand text-white">ถัดไป</button>
        </div>
      </section>

      <!-- Step 3: instructions -->
      <section id="view-instructions" class="hidden">
        <h2 class="text-xl font-semibold mb-3">คำชี้แจง</h2>
        <div class="p-4 bg-white rounded-2xl shadow-card leading-relaxed">
          <p>โปรดอ่านคำชี้แจงก่อนเริ่มทำแบบทดสอบ:</p>
          <ul class="list-disc pl-6 mt-2 text-gray-700">
            <li>ห้ามรีเฟรชหน้าในระหว่างทำข้อสอบ</li>
            <li>ระบบจะจับเวลาอัตโนมัติ</li>
            <li>ตอบครบทุกข้อก่อนส่ง</li>
          </ul>
        </div>
        <div class="mt-6 flex gap-3">
          <button id="btnBackToSetup" class="px-4 py-2 rounded-xl border">ย้อนกลับ</button>
          <button id="btnStart" class="px-4 py-2 rounded-xl bg-brand text-white">เริ่มทำแบบทดสอบ</button>
        </div>
      </section>

      <!-- Step 4: exam -->
      <section id="view-exam" class="hidden">
        <!-- Top toolbar -->
        <div class="flex items-center gap-4 mb-4">
          <div class="text-sm text-gray-600">
            <span id="badgeSubject" class="inline-flex items-center px-2.5 py-1 rounded-full bg-brandSoft text-brand"></span>
          </div>
          <div class="text-sm text-gray-600">
            <span id="badgeGrade" class="inline-flex items-center px-2.5 py-1 rounded-full bg-gray-100"></span>
          </div>
          <div class="ml-auto flex items-center gap-2">
            <div id="timerText" class="text-sm font-semibold">00:00</div>
          </div>
        </div>

        <div class="w-full h-2 bg-gray-200 rounded-full overflow-hidden mb-4">
          <div id="progressBar" class="h-full bg-brand" style="width:0%"></div>
        </div>

        <!-- Mobile: one-by-one -->
        <div id="mobileExam" class="md:hidden">
          <div id="mobileQuestionContainer" class="space-y-4"></div>
          <div class="mt-4 flex justify-between">
            <button id="btnPrev" class="px-4 py-2 rounded-xl border">ก่อนหน้า</button>
            <button id="btnNext" class="px-4 py-2 rounded-xl bg-brand text-white">ถัดไป</button>
          </div>
        </div>

        <!-- Desktop: multiple per page -->
        <div id="desktopExam" class="hidden md:block">
          <div id="desktopQuestionContainer" class="grid md:grid-cols-2 gap-4"></div>
          <div class="mt-4 flex items-center justify-between">
            <div id="pageInfo" class="text-sm text-gray-600"></div>
            <div class="flex gap-2">
              <button id="btnPagePrev" class="px-3 py-2 rounded-xl border">หน้าก่อน</button>
              <button id="btnPageNext" class="px-3 py-2 rounded-xl border">หน้าถัดไป</button>
              <button id="btnSubmit" class="px-3 py-2 rounded-xl bg-brand text-white">ส่งคำตอบ</button>
            </div>
          </div>
        </div>
      </section>

      <!-- Step 5: result -->
      <section id="view-result" class="hidden">
        <h2 class="text-xl font-semibold mb-3">สรุปผล</h2>
        <div id="resultBox" class="p-4 bg-white rounded-2xl shadow-card"></div>
        <div class="mt-4 flex gap-3">
          <button id="btnFinish" class="px-4 py-2 rounded-xl border">กลับหน้าแรก</button>
          <button id="btnPrintNow" class="hidden md:inline-flex px-4 py-2 rounded-xl border">พิมพ์</button>
        </div>
      </section>

      <!-- Skeleton / loading -->
      <section id="view-loading" class="py-10 text-center">
        <div class="animate-pulse text-gray-500">กำลังโหลด…</div>
      </section>
    </main>
  </div>

  <script src="./api.js"></script>
  <script src="./app.js"></script>
</body>
</html>
